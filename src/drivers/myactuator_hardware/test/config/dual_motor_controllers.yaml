# Dual Motor Test Controllers Configuration
# For 2 MyActuator RMD motors on CAN bus

controller_manager:
  ros__parameters:
    update_rate: 100  # Hz - USBCAN 하드웨어 한계 (~125Hz)
    
    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster
    
    # Joint trajectory controller for MoveIt (also works for teleop)
    joint_trajectory_controller:
      type: joint_trajectory_controller/JointTrajectoryController

joint_state_broadcaster:
  ros__parameters:
    use_local_topics: false

joint_trajectory_controller:
  ros__parameters:
    joints:
      - joint1
      - joint2
    command_interfaces:
      - position
    state_interfaces:
      - position
      - velocity
    allow_partial_joints_goal: false
    open_loop_control: false  # PID 사용하려면 false로 변경
    allow_integration_in_goal_trajectories: true
    allow_nonzero_velocity_at_trajectory_end: false
    
    # PID 게인 설정
    gains:
      joint1:
        p: 100.0    # 비례 게인
        i: 0.1      # 적분 게인  
        d: 10.0     # 미분 게인
        i_clamp: 1.0  # 적분 제한
        ff_velocity_scale: 1.0  # 속도 피드포워드
      joint2:
        p: 100.0
        i: 0.1
        d: 10.0
        i_clamp: 1.0
        ff_velocity_scale: 1.0
